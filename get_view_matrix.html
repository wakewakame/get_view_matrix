<html>
	<head>
	</head>
	<body>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.js"></script>
		<script src="/components.js"></script>
		<script type="text/javascript">
			// 参考URL : https://im-lab.net/artoolkit-overview/

			// カメラの解像度
			const cam_w = 1280;
			const cam_h = 720;
			// カメラの垂直画角
			const cam_h_fov = 70;
			// カメラ座標の原点から画面の中心までの距離(ピクセル単位)
			const cam_l = (0.5 * cam_h) / Math.tan(0.5 * cam_h_fov * 2 * Math.PI / 360);
			// カメラの水平画角
			const cam_w_fov = Math.atan((0.5 * cam_w) / cam_l) * 360 / Math.PI;

			let rootComponent;
			let marker = [
				new CursorComponent(100, 100),
				new CursorComponent(200, 100),
				new CursorComponent(200, 200),
				new CursorComponent(100, 200)
			];

			function setup() {
				createCanvas(cam_w, cam_h);
				rootComponent = new RootComponent();
				for(let m of marker) rootComponent.add(m);
			}

			function draw() {
				background(255, 255, 255);
				rootComponent.update();
				rootComponent.draw();
				noFill();
				stroke(0, 0, 0);
				strokeWeight(3);
				beginShape();
				for(let m of marker) vertex(m.pos().x, m.pos().y);
				if (marker.length > 0) vertex(marker[0].pos().x, marker[0].pos().y);
				endShape();
			}
		</script>
	</body>
</html>